<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Thêm mới câu hỏi</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        body {
            font-family: 'Arial', sans-serif;
            background: linear-gradient(120deg, #e0c3fc, #8ec5fc);
            padding: 20px;
        }

        .container {
            background: white;
            border-radius: 10px;
            padding: 20px;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.2);
        }

        h1 {
            color: #4a4e69;
        }

        .form-control,
        .form-select {
            border-radius: 6px;
        }

        .btn {
            background-color: #9a8c98;
            color: white;
            border: none;
        }

        .btn:hover {
            background-color: #4a4e69;
        }

        .answer-container {
            margin-top: 15px;
            padding: 15px;
            background: #f9f9f9;
            border-radius: 8px;
            border: 1px solid #ddd;
        }

        .error-message {
            color: red;
            font-size: 0.9rem;
        }
    </style>
</head>
<body>
<div class="container">
    <h1>Thêm mới câu hỏi</h1>
    <form id="questionForm">
        <!-- Tiêu đề -->
        <div class="mb-3">
            <label for="title" class="form-label">Tiêu đề câu hỏi</label>
            <input type="text" id="title" name="title" class="form-control" placeholder="Nhập tiêu đề câu hỏi" required>
            <div class="error-message" id="titleError"></div>
        </div>

        <!-- Danh mục câu hỏi -->
        <div class="mb-3">
            <label for="category" class="form-label">Danh mục câu hỏi</label>
            <select id="category" name="category" class="form-select" required>
                <option value="">Chọn danh mục</option>
                <option th:each="category : ${categories}" th:value="${category.id}" th:text="${category.name}"></option>
            </select>
            <div class="error-message" id="categoryError"></div>
        </div>

        <!-- Loại câu hỏi -->
        <div class="mb-3">
            <label for="type" class="form-label">Loại câu hỏi</label>
            <select id="type" name="type" class="form-select" required>
                <option value="">Chọn loại</option>
                <option value="1">Một lựa chọn</option>
                <option value="2">Nhiều lựa chọn</option>
                <option value="3">Đúng/Sai</option>
            </select>
            <div class="error-message" id="typeError"></div>
        </div>

        <!-- Độ khó -->
        <div class="mb-3">
            <label for="difficulty" class="form-label">Độ khó</label>
            <select id="difficulty" name="difficulty" class="form-select" required>
                <option value="">Chọn độ khó</option>
                <option value="easy">Dễ</option>
                <option value="normal">Trung bình</option>
                <option value="hard">Khó</option>
            </select>
            <div class="error-message" id="difficultyError"></div>
        </div>

        <!-- Câu trả lời -->
        <div class="answer-container">
            <label class="form-label">Đáp án</label>
            <div id="answerOptions"></div>
            <div class="error-message" id="answerError"></div>
        </div>

        <!-- Submit -->
        <button type="submit" class="btn mt-4">Thêm mới</button>
    </form>
</div>

<script>
    document.getElementById('type').addEventListener('change', function () {
        const type = this.value;
        const answerOptions = document.getElementById('answerOptions');
        answerOptions.innerHTML = ''; // Clear old options

        if (type === '1') {
            // Loại: Một lựa chọn (radio button)
            for (let i = 1; i <= 4; i++) {
                answerOptions.innerHTML += `
                    <div class="mb-3">
                        <input type="radio" name="correctAnswer" value="answer${i}" id="radio${i}" required>
                        <label for="radio${i}">Đáp án ${i}</label>
                        <input type="text" name="answer${i}" class="form-control mt-1" placeholder="Nội dung đáp án" required>
                    </div>`;
            }
        } else if (type === '2') {
            // Loại: Nhiều lựa chọn (checkbox)
            for (let i = 1; i <= 4; i++) {
                answerOptions.innerHTML += `
                    <div class="mb-3">
                        <input type="checkbox" name="correctAnswer" value="answer${i}" id="checkbox${i}">
                        <label for="checkbox${i}">Đáp án ${i}</label>
                        <input type="text" name="answer${i}" class="form-control mt-1" placeholder="Nội dung đáp án" required>
                    </div>`;
            }
        } else if (type === '3') {
            // Loại: Đúng/Sai (checkbox với 2 lựa chọn)
            answerOptions.innerHTML = `
                <div class="mb-3">
                    <input type="radio" name="correctAnswer" value="true" id="trueAnswer" required>
                    <label for="trueAnswer">Đúng</label>
                    <input type="text" name="answer1" class="form-control mt-1" placeholder="Nhập câu trả lời đúng" required>
                </div>
                <div class="mb-3">
                    <input type="radio" name="correctAnswer" value="false" id="falseAnswer" required>
                    <label for="falseAnswer">Sai</label>
                    <input type="text" name="answer2" class="form-control mt-1" placeholder="Nhập câu trả lời sai" required>
                </div>`;
        }
    });

    document.getElementById('questionForm').addEventListener('submit', function(event) {
        event.preventDefault();

        let isValid = true;

        // Validate title
        const title = document.getElementById('title');
        if (!title.value) {
            document.getElementById('titleError').textContent = 'Vui lòng nhập tiêu đề câu hỏi';
            isValid = false;
        } else {
            document.getElementById('titleError').textContent = '';
        }

        // Validate category
        const category = document.getElementById('category');
        if (!category.value) {
            document.getElementById('categoryError').textContent = 'Vui lòng chọn danh mục câu hỏi';
            isValid = false;
        } else {
            document.getElementById('categoryError').textContent = '';
        }

        // Validate type
        const type = document.getElementById('type');
        if (!type.value) {
            document.getElementById('typeError').textContent = 'Vui lòng chọn loại câu hỏi';
            isValid = false;
        } else {
            document.getElementById('typeError').textContent = '';
        }

        // Validate difficulty
        const difficulty = document.getElementById('difficulty');
        if (!difficulty.value) {
            document.getElementById('difficultyError').textContent = 'Vui lòng chọn độ khó';
            isValid = false;
        } else {
            document.getElementById('difficultyError').textContent = '';
        }

        // Validate answers (should add some conditions based on question type)
        const answerFields = document.querySelectorAll('[name^="answer"]');
        answerFields.forEach((input) => {
            if (!input.value) {
                document.getElementById('answerError').textContent = 'Vui lòng nhập tất cả các câu trả lời';
                isValid = false;
            } else {
                document.getElementById('answerError').textContent = '';
            }
        });

        if (isValid) {
            // Handle form submission
            alert("Form has been successfully submitted!");
            // Typically here you'd use an AJAX call to submit the form to the server
        }
    });
</script>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
</body>
